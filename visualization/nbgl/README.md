OpenGL Code borrowed from Kai Jia.
